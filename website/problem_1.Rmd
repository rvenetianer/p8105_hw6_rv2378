---
title: "Problem 1"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
---

```{r setup, include = FALSE}
library(flexdashboard)
library(tidyverse)
library(janitor)
library(haven)
library(dplyr)
library(tidyr)
library(knitr)
library(ggridges)
library(ggthemes)
library(stringr)
library(viridis)
library(plotly)
library(hexbin)
library(httr)
library(jsonlite)
library(forcats)
library(tidytext)
```


```{r, load csv, include = FALSE}
# Load csv of subsetted data
bakery_inspec = read.csv("bakery_inspec.csv")
bakery_inspec$score <- as.numeric(bakery_inspec$score)
```

Row {.tabset .tabset-fade}
-------------------------------------
    
### Chart 1

```{r, echo = FALSE}
# Reorder???
bakery_inspec$zipcode <- factor(bakery_inspec$zipcode, levels = unique(bakery_inspec$zipcode)[order(bakery_inspec$score, decreasing = FALSE)])

# Plot of score by zipcode
plot_ly(x = ~bakery_inspec$zipcode, y = ~bakery_inspec$score, color = bakery_inspec$zipcode, type = "bar")
```

   
### Chart 2

```{r}
# Plot scores for WaHi/Inwood bakeries
wahi_bakery <- bakery_inspec %>%
  group_by(dba) %>%
  filter(zipcode %in% c("10031", "10032", "10033", "10034", "10040"), critical_flag == 
           "Critical")

plot_ly(x = ~wahi_bakery$inspection_type, y = ~wahi_bakery$score, 
        color = ~wahi_bakery$inspection_type, type = "bar")
```

### Bakeries with Critical Levels per Borough

```{r bar plot criticals in each boro}
bakery_inspec %>%
  filter(boro != "Missing") %>% 
  plot_ly(x = ~boro, y=~score, color = ~critical_flag, type = "bar")
```


### Bakery Scores per Borough

```{r box plot score in each boro}
bakery_inspec %>%
<<<<<<< HEAD
=======
<<<<<<< HEAD
bakery_inspec %>%
=======
bakery_inspe %>%
>>>>>>> b36dfa85125b26e69707df1e672a1fef28b3e7de
>>>>>>> 595b6c7410eb5f06d1d84d0e9d89f90d2de1006c
=======
>>>>>>> 00f96266bbc6456e9e560089b263fd5f2e6dd001
  filter(boro != "Missing") %>%
  plot_ly(y=~score, color = ~boro, type = "box")
```

