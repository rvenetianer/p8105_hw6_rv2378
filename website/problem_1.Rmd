---
title: "Problem 1"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include = FALSE}
library(flexdashboard)
library(tidyverse)
library(janitor)
library(readr)
library(haven)
library(readxl)
library(dplyr)
library(tidyr)
library(knitr)
library(ggridges)
library(ggthemes)
library(stringr)
library(viridis)
library(plotly)
library(hexbin)
```

```{r, load and clean data, include = FALSE}
ny_noaa = read_csv("../data/nynoaadat.csv", 
                   col_types = "cDiiidd") %>%
  separate(date, into = c("year", "month", "day"))
```

Column {data-width=650}
-----------------------------------------------------------------------

### Temperature Comparison

```{r, echo = FALSE}
scatterplot_temp <- ny_noaa %>% 
  mutate(tmax = as.numeric(tmax),tmin = as.numeric(tmin)) %>% 
  filter(id %in% sample(ny_noaa$id, size = 2, replace = FALSE)) %>% 
  ggplot(aes(x = tmax, y = tmin, group = id)) +
  labs(title = "Maximum temperature vs. minimum temperature", 
       x = "Maximum temperature", y = "Minimum temperature") +
  geom_point(aes(color = year), alpha = 0.5) 

ggplotly(scatterplot_temp)
```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}
box_ggplot = 
  ggplot(data = ny_noaa, aes(x = ny_noaa$year, y = tmax, fill = year)) +
  geom_boxplot() +
  theme_classic() + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

ggplotly(box_ggplot)
```

### Chart C

```{r}
ny_noaa %>% 
  count(year) %>%
  plot_ly(x = ~ny_noaa$year, y = ~ny_noaa$snwd, type = "bar")

## largest snow per year
```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart D

```{r}
# min temp and snow
```